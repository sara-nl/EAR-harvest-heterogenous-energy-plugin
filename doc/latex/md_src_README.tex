E\+AR is composed by four main components\+: E\+AR Library, E\+AR (node) Daemon, E\+AR Global Manager Daemon, and E\+AR Database Daemon. The E\+AR Library (./library/\+R\+E\+A\+D\+ME.md \char`\"{}\+E\+A\+R\+L\char`\"{}) and E\+AR Daemon (./daemon/\+R\+E\+A\+D\+ME.md \char`\"{}\+E\+A\+R\+D\char`\"{}) together are the core of the E\+AR package.

\subsection*{E\+AR library}

The E\+AR Library interceps the Profiling M\+PI Interface (P\+M\+PI) symbols using the dynamic loader environment variable {\ttfamily L\+D\+\_\+\+P\+R\+E\+L\+O\+AD}.

Each intercepted call executes the Dyn\+A\+IS algorithm to detect the tipical repetitive sequences of code found in the regular H\+PC applications. Once found a new repetitive sequence, metrics like C\+PI, memory bandwidth and node power consumption are calculated.

This data, called the {\bfseries application signature}, together with the node characterization, called the {\bfseries system signature}, allows the library to predict the performance (time) and power consumption for an iteration of a repetitive sequence for the list of available frequencies.

Given the predictions and the power policy, the {\itshape best} C\+PU frequency is selected. For instance, given an application with a memory intensive behavior, E\+A\+RL will\+: 1) Detect dynamically the iterative section for the application. 2) Compute the application signature. 3) Apply perforance and power models. 4) Apply the power policy. 5) And finally, select and change the C\+PU frequency. In that kind of applications, reducing the C\+PU frequency will not significantly affect the application performance.

The system signature is a set of coefficients and it\textquotesingle{}s computed once at configuration time. The process of computing the system signature is called the {\bfseries learning phase}. It consist in the execution of a set of pre-\/selected stressing benchmarks included in the package distribution. The application signature is computed at runtime since it characterizes the application.

\subsection*{E\+AR (node) Daemon}

E\+AR Daemon (./daemon/\+R\+E\+A\+D\+ME.md \char`\"{}\+E\+A\+R\+D\char`\"{}) is a daemon running in all the compute nodes. It is a core component and It provides three types of services\+: access to privileged metrics, periodic power monitoring and power control commands.

E\+A\+RD is used by the library to read those metrics that requires root privileges. It also offers a simplified A\+PI to be used by applications. This A\+PI only provides the reading of the metrics (not control operations such as changing the frequency).

Moreover, each E\+A\+RD is continuosly monitoring the node and reporting information to the DB through the E\+A\+R\+D\+BD. This information is used later by the E\+AR Global Manager.

Finally, E\+A\+RD offers a privileged A\+PI to change power policy settings.

\subsection*{E\+AR Global Manager}

The E\+AR Global Manager Daemon (./global\+\_\+manager/\+R\+E\+A\+D\+ME.md \char`\"{}\+E\+A\+R\+G\+M\+D\char`\"{}) is a step beyond than the original daemon and library package. All the H\+PC clusters must control the energy consumed and, moreover, some others have limitations beacuse of the infrastructure. The E\+AR Global Manager can be used in {\bfseries passive} mode or {\bfseries active} mode.

When configured in passive mode, the E\+A\+R\+G\+MD will monitor the energy consumed in the system, reporting warnings to the database or performing simple actions such as sending mails).

When configured in active mode, the E\+A\+R\+G\+MD will automatically react to energy warnings detected. The current E\+A\+R\+G\+MD only supports predefined levels and actions in automatic mode, but a new version where different levels and actions will be configured through the {\ttfamily ear.\+conf} file (or a similar approach) is being developed.

\subsection*{E\+AR Database daemon}

The E\+AR Database Daemon (./database\+\_\+cache/\+R\+E\+A\+D\+ME.md \char`\"{}\+E\+A\+R\+D\+B\+D\char`\"{}) collects records generated by E\+A\+RL and E\+A\+RD and reports them to the centralized database. Few E\+A\+R\+D\+BD\textquotesingle{}s will run in the cluster reducing the number of inserts to the database and providing aggregated metrics for some of the records.

\subsection*{E\+AR S\+L\+U\+RM plugin}

Finally, the ./slurm\+\_\+plugin/\+R\+E\+A\+D\+ME.md \char`\"{}\+E\+A\+R S\+L\+U\+R\+M plugin\char`\"{}, a lesser component which helps to connect all the main components focusing in the ease of use. It is a S\+L\+U\+RM S\+P\+A\+NK type plugin, extending the {\ttfamily run} and {\ttfamily sbatch} options. 