\hypertarget{uncores__pci_8c}{}\section{src/metrics/custom/bandwidth/uncores\+\_\+pci.c File Reference}
\label{uncores__pci_8c}\index{src/metrics/custom/bandwidth/uncores\+\_\+pci.\+c@{src/metrics/custom/bandwidth/uncores\+\_\+pci.\+c}}
{\ttfamily \#include $<$fcntl.\+h$>$}\\*
{\ttfamily \#include $<$errno.\+h$>$}\\*
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include $<$unistd.\+h$>$}\\*
{\ttfamily \#include $<$linux/limits.\+h$>$}\\*
{\ttfamily \#include $<$metrics/custom/hardware\+\_\+info.\+h$>$}\\*
{\ttfamily \#include $<$metrics/custom/bandwidth/uncores\+\_\+pci.\+h$>$}\\*
{\ttfamily \#include $<$common/types/generic.\+h$>$}\\*
{\ttfamily \#include $<$common/ear\+\_\+verbose.\+h$>$}\\*
{\ttfamily \#include $<$common/states.\+h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{uncores__pci_8c_a8ee7ee440014c2c253599b3c8b850876}{I\+J\+K\+F\+OR}(i\+\_\+len,  j\+\_\+len,  k\+\_\+len)
\item 
\#define \hyperlink{uncores__pci_8c_a0e4e815cacc8ecc6460591ceb5fd1290}{pci\+\_\+case}(arch,  retval)                                                
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{uncores__pci_8c_a499e382311707dd19803d48ad7aea9ac}{pci\+\_\+check\+\_\+uncores} ()
\begin{DoxyCompactList}\small\item\em Checks if the found pci uncore functions have any abnormality. \end{DoxyCompactList}\item 
int \hyperlink{uncores__pci_8c_a25da0ac7eb5637d5f7ee23dea116b29f}{pci\+\_\+init\+\_\+uncores} (int \hyperlink{test__architecture_8c_acfede048b49209a0d8f7d773aa176e65}{cpu\+\_\+model})
\begin{DoxyCompactList}\small\item\em Scans P\+CI buses and allocates file descriptors memory. \end{DoxyCompactList}\item 
int \hyperlink{uncores__pci_8c_a070bfe7a3a3e26a28f1ee9093c525e36}{pci\+\_\+count\+\_\+uncores} ()
\begin{DoxyCompactList}\small\item\em Get the number of performance monitor counters. \end{DoxyCompactList}\item 
int \hyperlink{uncores__pci_8c_a8aa3e0127c0f8f880a5160f733a39ae6}{pci\+\_\+reset\+\_\+uncores} ()
\begin{DoxyCompactList}\small\item\em Freezes and resets all performance monitor uncore counters. \end{DoxyCompactList}\item 
int \hyperlink{uncores__pci_8c_a35a24d64ff060cc2b67c34c408c6b283}{pci\+\_\+start\+\_\+uncores} ()
\begin{DoxyCompactList}\small\item\em Unfreezes all P\+CI uncore counters. \end{DoxyCompactList}\item 
int \hyperlink{uncores__pci_8c_add7a5c24adcee64bac4268b3555567ea}{pci\+\_\+stop\+\_\+uncores} (\hyperlink{generic_8h_aa5114a4fed348a29fb92123470476b1b}{ull} $\ast$\hyperlink{energy__cpu_8c_ab805d4eab86acb3d624dd5b16f94db88}{values})
\begin{DoxyCompactList}\small\item\em Freezes all P\+M\+ON uncore counters and gets it\textquotesingle{}s values. \end{DoxyCompactList}\item 
int \hyperlink{uncores__pci_8c_ae1a89fc880dbded4ce80f0cf33f2e9de}{pci\+\_\+read\+\_\+uncores} (\hyperlink{generic_8h_aa5114a4fed348a29fb92123470476b1b}{ull} $\ast$\hyperlink{energy__cpu_8c_ab805d4eab86acb3d624dd5b16f94db88}{values})
\begin{DoxyCompactList}\small\item\em Gets uncore counters values. \end{DoxyCompactList}\item 
int \hyperlink{uncores__pci_8c_a547b6d85706d89b406b8d330b3cbdc0c}{pci\+\_\+dispose\+\_\+uncores} ()
\begin{DoxyCompactList}\small\item\em Closes file descriptors and frees memory. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}!I\+J\+K\+F\+OR@{I\+J\+K\+F\+OR}}
\index{I\+J\+K\+F\+OR@{I\+J\+K\+F\+OR}!uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}}
\subsubsection[{\texorpdfstring{I\+J\+K\+F\+OR}{IJKFOR}}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+J\+K\+F\+OR(
\begin{DoxyParamCaption}
\item[{}]{i\+\_\+len, }
\item[{}]{j\+\_\+len, }
\item[{}]{k\+\_\+len}
\end{DoxyParamCaption}
)}\hypertarget{uncores__pci_8c_a8ee7ee440014c2c253599b3c8b850876}{}\label{uncores__pci_8c_a8ee7ee440014c2c253599b3c8b850876}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keywordflow}{for}(\hyperlink{coeffs__compute_8c_aa0ecde9bec2f4c6686780ccf4f5fe835}{i} = 0; \hyperlink{coeffs__compute_8c_aa0ecde9bec2f4c6686780ccf4f5fe835}{i} < i\_len; \hyperlink{coeffs__compute_8c_aa0ecde9bec2f4c6686780ccf4f5fe835}{i}++)      \(\backslash\)
    \textcolor{keywordflow}{for}(j = 0; j < j\_len; j++)      \(\backslash\)
    \textcolor{keywordflow}{for}(k = 0; k < k\_len; k++)
\end{DoxyCode}
\index{uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}!pci\+\_\+case@{pci\+\_\+case}}
\index{pci\+\_\+case@{pci\+\_\+case}!uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}}
\subsubsection[{\texorpdfstring{pci\+\_\+case}{pci_case}}]{\setlength{\rightskip}{0pt plus 5cm}\#define pci\+\_\+case(
\begin{DoxyParamCaption}
\item[{}]{arch, }
\item[{}]{retval}
\end{DoxyParamCaption}
)}\hypertarget{uncores__pci_8c_a0e4e815cacc8ecc6460591ceb5fd1290}{}\label{uncores__pci_8c_a0e4e815cacc8ecc6460591ceb5fd1290}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keywordflow}{case} arch:                                          \(\backslash\)
    *length = (int) \textcolor{keyword}{sizeof}(retval) / \textcolor{keyword}{sizeof}(retval[0]); \(\backslash\)
    return retval;
\end{DoxyCode}


\subsection{Function Documentation}
\index{uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}!pci\+\_\+check\+\_\+uncores@{pci\+\_\+check\+\_\+uncores}}
\index{pci\+\_\+check\+\_\+uncores@{pci\+\_\+check\+\_\+uncores}!uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}}
\subsubsection[{\texorpdfstring{pci\+\_\+check\+\_\+uncores()}{pci_check_uncores()}}]{\setlength{\rightskip}{0pt plus 5cm}int pci\+\_\+check\+\_\+uncores (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{uncores__pci_8c_a499e382311707dd19803d48ad7aea9ac}{}\label{uncores__pci_8c_a499e382311707dd19803d48ad7aea9ac}


Checks if the found pci uncore functions have any abnormality. 

Returned values are E\+A\+R\+\_\+\+S\+U\+C\+C\+E\+SS, E\+A\+R\+\_\+\+W\+A\+R\+N\+I\+NG or E\+A\+R\+\_\+\+E\+R\+R\+OR. \index{uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}!pci\+\_\+count\+\_\+uncores@{pci\+\_\+count\+\_\+uncores}}
\index{pci\+\_\+count\+\_\+uncores@{pci\+\_\+count\+\_\+uncores}!uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}}
\subsubsection[{\texorpdfstring{pci\+\_\+count\+\_\+uncores()}{pci_count_uncores()}}]{\setlength{\rightskip}{0pt plus 5cm}int pci\+\_\+count\+\_\+uncores (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{uncores__pci_8c_a070bfe7a3a3e26a28f1ee9093c525e36}{}\label{uncores__pci_8c_a070bfe7a3a3e26a28f1ee9093c525e36}


Get the number of performance monitor counters. 

\hyperlink{uncores__pci_8h_a25da0ac7eb5637d5f7ee23dea116b29f}{pci\+\_\+init\+\_\+uncores()} have to be called before. Returns the number of P\+CI uncore counters. \index{uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}!pci\+\_\+dispose\+\_\+uncores@{pci\+\_\+dispose\+\_\+uncores}}
\index{pci\+\_\+dispose\+\_\+uncores@{pci\+\_\+dispose\+\_\+uncores}!uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}}
\subsubsection[{\texorpdfstring{pci\+\_\+dispose\+\_\+uncores()}{pci_dispose_uncores()}}]{\setlength{\rightskip}{0pt plus 5cm}int pci\+\_\+dispose\+\_\+uncores (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{uncores__pci_8c_a547b6d85706d89b406b8d330b3cbdc0c}{}\label{uncores__pci_8c_a547b6d85706d89b406b8d330b3cbdc0c}


Closes file descriptors and frees memory. 

Returns 0 on success or E\+A\+R\+\_\+\+E\+R\+R\+OR. \index{uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}!pci\+\_\+init\+\_\+uncores@{pci\+\_\+init\+\_\+uncores}}
\index{pci\+\_\+init\+\_\+uncores@{pci\+\_\+init\+\_\+uncores}!uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}}
\subsubsection[{\texorpdfstring{pci\+\_\+init\+\_\+uncores(int cpu\+\_\+model)}{pci_init_uncores(int cpu_model)}}]{\setlength{\rightskip}{0pt plus 5cm}int pci\+\_\+init\+\_\+uncores (
\begin{DoxyParamCaption}
\item[{int}]{cpu\+\_\+model}
\end{DoxyParamCaption}
)}\hypertarget{uncores__pci_8c_a25da0ac7eb5637d5f7ee23dea116b29f}{}\label{uncores__pci_8c_a25da0ac7eb5637d5f7ee23dea116b29f}


Scans P\+CI buses and allocates file descriptors memory. 

Returns the number of uncores counters on success or E\+A\+R\+\_\+\+E\+R\+R\+OR. \index{uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}!pci\+\_\+read\+\_\+uncores@{pci\+\_\+read\+\_\+uncores}}
\index{pci\+\_\+read\+\_\+uncores@{pci\+\_\+read\+\_\+uncores}!uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}}
\subsubsection[{\texorpdfstring{pci\+\_\+read\+\_\+uncores(ull $\ast$values)}{pci_read_uncores(ull *values)}}]{\setlength{\rightskip}{0pt plus 5cm}int pci\+\_\+read\+\_\+uncores (
\begin{DoxyParamCaption}
\item[{unsigned long long $\ast$}]{values}
\end{DoxyParamCaption}
)}\hypertarget{uncores__pci_8c_ae1a89fc880dbded4ce80f0cf33f2e9de}{}\label{uncores__pci_8c_ae1a89fc880dbded4ce80f0cf33f2e9de}


Gets uncore counters values. 

Returns 0. \index{uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}!pci\+\_\+reset\+\_\+uncores@{pci\+\_\+reset\+\_\+uncores}}
\index{pci\+\_\+reset\+\_\+uncores@{pci\+\_\+reset\+\_\+uncores}!uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}}
\subsubsection[{\texorpdfstring{pci\+\_\+reset\+\_\+uncores()}{pci_reset_uncores()}}]{\setlength{\rightskip}{0pt plus 5cm}int pci\+\_\+reset\+\_\+uncores (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{uncores__pci_8c_a8aa3e0127c0f8f880a5160f733a39ae6}{}\label{uncores__pci_8c_a8aa3e0127c0f8f880a5160f733a39ae6}


Freezes and resets all performance monitor uncore counters. 

Returns 0 on success or E\+A\+R\+\_\+\+E\+R\+R\+OR. \index{uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}!pci\+\_\+start\+\_\+uncores@{pci\+\_\+start\+\_\+uncores}}
\index{pci\+\_\+start\+\_\+uncores@{pci\+\_\+start\+\_\+uncores}!uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}}
\subsubsection[{\texorpdfstring{pci\+\_\+start\+\_\+uncores()}{pci_start_uncores()}}]{\setlength{\rightskip}{0pt plus 5cm}int pci\+\_\+start\+\_\+uncores (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{uncores__pci_8c_a35a24d64ff060cc2b67c34c408c6b283}{}\label{uncores__pci_8c_a35a24d64ff060cc2b67c34c408c6b283}


Unfreezes all P\+CI uncore counters. 

Returns 0 on success or E\+A\+R\+\_\+\+E\+R\+R\+OR. \index{uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}!pci\+\_\+stop\+\_\+uncores@{pci\+\_\+stop\+\_\+uncores}}
\index{pci\+\_\+stop\+\_\+uncores@{pci\+\_\+stop\+\_\+uncores}!uncores\+\_\+pci.\+c@{uncores\+\_\+pci.\+c}}
\subsubsection[{\texorpdfstring{pci\+\_\+stop\+\_\+uncores(ull $\ast$values)}{pci_stop_uncores(ull *values)}}]{\setlength{\rightskip}{0pt plus 5cm}int pci\+\_\+stop\+\_\+uncores (
\begin{DoxyParamCaption}
\item[{unsigned long long $\ast$}]{values}
\end{DoxyParamCaption}
)}\hypertarget{uncores__pci_8c_add7a5c24adcee64bac4268b3555567ea}{}\label{uncores__pci_8c_add7a5c24adcee64bac4268b3555567ea}


Freezes all P\+M\+ON uncore counters and gets it\textquotesingle{}s values. 

The array has to be greater or equal than the number of P\+M\+ON uncore counters returned by \hyperlink{bandwidth_8c_af4578eaafbdc0c0bd26da3a08c8c1754}{count\+\_\+uncores()} function. The returned values are the read and write bandwidth values in index \mbox{[}i\mbox{]} and \mbox{[}i+1\mbox{]} respectively. Returns 0 on success or E\+A\+R\+\_\+\+E\+R\+R\+OR. 