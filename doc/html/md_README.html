<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>EAR: Energy Aware Runtime</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EAR
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Energy Aware Runtime </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Overview </h2>
<div class="image">
<img src="etc/images/logo.png"  align="right" width="140"/>
</div>
<p> Energy Aware Runtime (EAR) package provides an energy efficient solution for super computers. EAR includes a runtime library that dynamically selects the CPU frequency for MPI applications based on the program characterization done at runtime, node characteristics and power policy settings. The library doesn't need neither a prior information nor user input.</p>
<p>EAR also provides mechanism for those experts users that perfectly knows their application, to change the frequency and view the effects in form of metrics.</p>
<p>EAR library has been integrated in a full energy management system incluing a complete accounting mechanism, and a global energy manager. All the componets together provides three main services:</p>
<p>1- A <b>simple and ligthweigth system</b> to automatically select the optimal CPU frequency according to the application, the node, and the power policy. This services is provided by two components: the EAR library (<b>EARL</b>) and the EAR daemon (<b>EARD</b>). EARL is a smart component which selects the CPU frequency for the running applications. EARD is provides basic services to the rest of components (not only EARL).</p>
<p>2- A complete <b>energy accounting system</b> based on MySQL database. The energy accounting system is configurable in terms of application details and updates frequency.</p>
<p>3- A <b>global energy manager</b> which monitors and controls the energy consumed in the system. Energy control is configurable and dynamically adapts power policy settings based on global energy limits and application characteristics.</p>
<p>All three components are configurable using a single, centralized, and simple text file called 'ear.conf'. This mechanism makes easy the cluster definition and configuration. This 'ear.conf' includes default values, pre-defined application configurations, etc. More details can be found in ./etc/conf/README.md "configuration section".</p>
<p>Please visit ./src/README.md "the main components page" for a detailed description of each of the main components of EAR.</p>
<h2>Requirements </h2>
<p>EAR requires some third party libraríes and headers to compile and run, in addition to the basic requirements such as the compiler and Autoconf. This is a list of these <b>libraries</b>, minimum <b>tested</b> versions and its references:</p>
<table class="doxtable">
<tr>
<th>Library </th><th>Required / comment </th><th>Minimum version </th><th>References  </th></tr>
<tr>
<td>PAPI </td><td>Yes / with RAPL </td><td>5.4.3.0 </td><td><a href="http://icl.utk.edu/papi/">Website</a> </td></tr>
<tr>
<td>GSL </td><td>Yes </td><td>1.4 </td><td><a href="https://www.gnu.org/software/gsl/">Website</a> </td></tr>
<tr>
<td>CPUPower </td><td>Yes </td><td>Kernel 3.10* </td><td><a href="https://wiki.archlinux.org/index.php/CPU_frequency_scaling">Information</a> </td></tr>
<tr>
<td>FreeIPMI </td><td>Yes </td><td>1.5.7 </td><td><a href="https://www.gnu.org/software/freeipmi/">Website</a> </td></tr>
<tr>
<td>SLURM </td><td>Just for SLURM plugin </td><td>17.02.6 </td><td><a href="https://slurm.schedmd.com/">Website</a> </td></tr>
<tr>
<td>MPI </td><td>Yes </td><td>- </td><td>- </td></tr>
<tr>
<td>MySQL </td><td>No </td><td>- </td><td>- </td></tr>
</table>
<p>* Depending on the version, may you have to change the name of the library function call (or the parameter).</p>
<p>Also, some <b>drivers</b> has to be present and loaded in the system:</p>
<table class="doxtable">
<tr>
<th>Driver </th><th>File </th><th>Kernel version </th><th>References  </th></tr>
<tr>
<td>CPUFreq </td><td>kernel/drivers/cpufreq/acpi-cpufreq.ko </td><td>3.10 </td><td><a href="https://wiki.archlinux.org/index.php/CPU_frequency_scaling">Information</a> </td></tr>
<tr>
<td>Open IPMI </td><td>kernel/drivers/char/ipmi/*.ko </td><td>3.10 </td><td><a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/cwlin/configuring-the-open-ipmi-driver.html">Information</a> </td></tr>
</table>
<p>Lastly, the <b>compilers</b>:</p>
<table class="doxtable">
<tr>
<th>Compiler </th><th>Comment </th><th>Minimum version </th><th>References  </th></tr>
<tr>
<td>GNU Compiler Collection (GCC) </td><td>For the library and daemon </td><td>4.8.5 </td><td><a href="https://gcc.gnu.org/">Website</a> </td></tr>
<tr>
<td>Intel C Compiler (ICC) </td><td>For the library and daemon </td><td>17.0.1 </td><td><a href="https://software.intel.com/en-us/c-compilers">Website</a> </td></tr>
<tr>
<td>Intel Fortran Compiler (MPIIFort) </td><td>For some kernels </td><td>17.0.1 </td><td><a href="https://software.intel.com/en-us/fortran-compilers">Website</a> </td></tr>
</table>
<p>Just one C compiler next to its MPI scripts is needed.</p>
<h2>Brief installation guide </h2>
<p>1) Generate Autoconf's <code>configure</code> program by typing <code>autoreconf -i</code>. 2) Compile the library by typing <code>./configure</code>, <code>make</code> and <code>make install</code> in the root directory. Consider the option of <code>./configure --PREFIX=&lt;path&gt;</code> if you want to specify the installation path. It could be useful to run ‘./configure &ndash;help’ for listing the options details.</p>
<h2>Customize installation </h2>
<p><code>configure</code> is based on shell variables which initial value could be given by setting variables in the command line, or in the environment. Take a look to the table with the most popular variables:</p>
<table class="doxtable">
<tr>
<th>Variable </th><th>Description  </th></tr>
<tr>
<td>DEBUG </td><td>Enables debug messages [0..4]. Debug messages with lower or equal level are printed. </td></tr>
<tr>
<td>MPICC </td><td>C compiler MPI script. </td></tr>
<tr>
<td>OMPICC </td><td>OpenMPI compiler. </td></tr>
<tr>
<td>CC </td><td>C compiler command. </td></tr>
<tr>
<td>CFLAGS </td><td>C compiler flags. </td></tr>
<tr>
<td>LDFLAGS </td><td>Linker flags. E.g. ‘-L&lt;lib dir&gt;’ if you have libraries in a nonstandard directory &lt;lib dir&gt;. </td></tr>
<tr>
<td>LIBS </td><td>Libraries to pass to the linker. E.g. ‘-l&lt;library&gt;’. </td></tr>
<tr>
<td>CPPFLAGS </td><td>C/C++ preprocessor flags, e.g. -I&lt;include dir&gt; if you have headers in a nonstandard directory &lt;include dir&gt;. </td></tr>
<tr>
<td>TMP </td><td>Defines the node local storage as 'var', 'tmp' or other tempfs file system (default: /var/ear) (you can alo use &ndash;localstatedir=DIR) </td></tr>
<tr>
<td>ETC </td><td>Defines the read-only single-machine data as 'etc' (default: EPREFIX/etc) (you can also use &ndash;sharedstatedir=DIR) </td></tr>
<tr>
<td>MAN </td><td>Defines the documentation directory (default: PREFIX/man) (you can use also &ndash;mandir=DIR) </td></tr>
</table>
<ul>
<li>This is an example of <code>CC</code>, <code>CFLAGS</code> and <code>DEBUG</code> variables overwriting:  <code>./configure CC=c99 CFLAGS=-g DEBUG=4</code></li>
</ul>
<p>You can choose the root folder by typing <code>./configure --PREFIX=&lt;path&gt;</code>. But there are other options in the following table:</p>
<table class="doxtable">
<tr>
<th>Definition </th><th>Default directory </th><th>Content / description  </th></tr>
<tr>
<td>&lt;<em>PREFIX</em>&gt; </td><td>/usr/local </td><td>Installation path </td></tr>
<tr>
<td>&lt;<em>ETC</em>&gt; </td><td>&lt;<em>PREFIX</em>&gt;/etc </td><td>Configuration files. </td></tr>
<tr>
<td>&lt;<em>TMP</em>&gt; </td><td>/var/ear </td><td>Pipes and temporal files. </td></tr>
</table>
<p>This is the list of the inner installation folders and their content:</p>
<table class="doxtable">
<tr>
<th>Directory </th><th>Root </th><th>Content / description  </th></tr>
<tr>
<td>/lib </td><td>&lt;<em>PREFIX</em>&gt; </td><td>Libraries. </td></tr>
<tr>
<td>/bin </td><td>&lt;<em>PREFIX</em>&gt; </td><td>Tools and benchmark kernels. </td></tr>
<tr>
<td>/bin/kernels </td><td>&lt;<em>PREFIX</em>&gt; </td><td>Benchmarks (or stress tests). </td></tr>
<tr>
<td>/sbin </td><td>&lt;<em>PREFIX</em>&gt; </td><td>Privileged components. </td></tr>
<tr>
<td>/scripts </td><td>&lt;<em>PREFIX</em>&gt; </td><td>Scripts. </td></tr>
<tr>
<td>/man </td><td>&lt;<em>PREFIX</em>&gt; </td><td>Documentation. </td></tr>
<tr>
<td>/ear </td><td>&lt;<em>ETC</em>&gt; </td><td>Configuration file. </td></tr>
<tr>
<td>/module </td><td>&lt;<em>ETC</em>&gt; </td><td>Environment module. </td></tr>
<tr>
<td>/slurm </td><td>&lt;<em>ETC</em>&gt; </td><td>plugstack.conf. </td></tr>
<tr>
<td>/systemd </td><td>&lt;<em>ETC</em>&gt; </td><td>Unit services. </td></tr>
</table>
<p>You have more installation options information by typing <code>./configure --help</code>.</p>
<h2>Adding required libraries installed in custom locations </h2>
<p>You can help <code>configure</code> to find PAPI, SLURM, or other required libraries in case you installed in a custom location. It is necessary to add its root path for the compiler to see include headers and libraries for the linker. You can do this by adding to it the following arguments:</p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Description  </th></tr>
<tr>
<td>&ndash;with-papi=&lt;path&gt; </td><td>Specifies the path to PAPI installation. </td></tr>
<tr>
<td>&ndash;with-gsl=&lt;path&gt; </td><td>Specifies the path to GSL installation. </td></tr>
<tr>
<td>&ndash;with-cpupower=&lt;path&gt; </td><td>Specifies the path to CPUPower installation. </td></tr>
<tr>
<td>&ndash;with-slurm=&lt;path&gt; </td><td>Specifies the path to SLURM installation. </td></tr>
<tr>
<td>&ndash;with-freeipmi=&lt;path&gt; </td><td>Specifies the path to FreeIPMI installation. </td></tr>
<tr>
<td>&ndash;with-mysql=&lt;path&gt; </td><td>Specify path to MySQL installation. </td></tr>
</table>
<p>* This is an example of ‘CC‘ overwriting and PAPI path specification:<br />
 <code>./configure --with-papi=/path/to/PAPI</code></p>
<p>If unusual procedures must be done to compile the package, please try to figure out how <code>configure</code> could check whether to do them and contact the team to be considered for the next release. In the meantime, you can overwrite shell variables or export its paths to the environment (e.g. LD_LIBRARY).</p>
<h2>Unit services </h2>
<p>The way to launch the EAR daemons is by unit services method. The generated unit services for the EAR Daemon, EAR Global Manager Daemon and EAR Database Daemon are generated and installed in <code>/systemd</code>. You have to copy those unit service files to your <code>systemd</code> operating system folder. Once copied, use the <code>systemctl</code> command to run the daemons.</p>
<p>Check the ./src/daemon/README.md "EARD", ./src/database_cache/README.md "EARDBD", ./src/global_manager/README.md "EARGMD" pages to find the precise execution commands.</p>
<p>Finally, when using <code>systemctl</code> commands, you can check messages reported by the stderr using journalctl. For instance: <code>journalctl -u eard -f</code></p>
<h2>Configuration </h2>
<p>1) Depending on your environment:</p><ul>
<li>In case you are going to use <b>EAR together with SLURM</b>, visit the https://github.com/BarcelonaSupercomputingCenter/EAR/blob/development/src/slurm_plugin/README.md "SLURM plugin page" to add the plugin to your SLURM installation.</li>
<li>In case you are going to use <b>EAR with direct MPI calls</b>, visit the https://github.com/BarcelonaSupercomputingCenter/EAR/blob/development/etc/scripts/README.md "scripts page" for more information about the scripts that simplify the launch. 2) Pass the learning phase in all your computing nodes by visiting the https://github.com/BarcelonaSupercomputingCenter/EAR/blob/development/etc/scripts/learning/README.md "learning phase page" to follow its guide.</li>
</ul>
<h2>User guide </h2>
<p>Finally, you can launch any MPI application next to EAR library by following the https://github.com/BarcelonaSupercomputingCenter/EAR/blob/development/src/library/README.md "library user guide".</p>
<h2>License </h2>
<p>All the files in the EAR framework are under the LGPLv2.1 license. See the <a href="../../COPYING">COPYING</a> file in the EAR root directory. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
