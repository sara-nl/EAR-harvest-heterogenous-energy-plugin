<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>EAR: EAR configuration file</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EAR
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">EAR configuration file </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><code>ear.conf</code> is a text file describing the EAR package behavior in the cluster. It must be readable by all compute nodes and by nodes where commands are executed.</p>
<p>Usually the first word in the configuration file expresses the component related with the option. Lines starting with # are comments. Not all the options and arguments are required because some of the components or functionallity could be disabled.</p>
<p>A test for ear.conf file can be found in the path <code>src/test/functionals/ear_conf</code></p>
<h1>Services configuration parameters</h1>
<p>1) MariaDB configuration</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# The IP or hostname of the node where the MariaDB (MySQL) process is running.</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;MariaDBIp=172.30.2.101</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;#</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;MariaDBUser=ear_daemon</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;#</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;MariaDBPort=0</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;#</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;MariaDBPassw=</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;#</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;MariaDBDatabase=EAR_DB</div></div><!-- fragment --><p>2) EAR Global Manager (EARGMD)</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Verbose level</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;GlobalManagerVerbose=1</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# Period T1 and period T2 are specified in seconds. T1 must be less than T2. (i.e. 10 min and 1 month)</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;GlobalManagerPeriodT1=90</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;GlobalManagerPeriodT2=259200</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;# Units field, Can be &#39;-&#39; (Joules), &#39;K&#39; KiloJoules or &#39;M&#39; MegaJoules</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;GlobalManagerUnits=K</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;#</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;GlobalManagerEnergyLimit=550000</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;# Use &#39;1&#39; or not &#39;0&#39; aggregated metrics to compute total energy.</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;GlobalManagerUseAggregated=1</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;# The IP or hostname of the node where the EARGMD demon is running.</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;GlobalManagerHost=hostname</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;# Port where EARGMD will be listening.</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;GlobalManagerPort=50000</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;# Global manager modes. Two modes are supported &#39;0&#39; (manual) or &#39;1&#39; (automatic)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;GlobalManagerMode=0</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;# A mail can be sent reporting the warning level (and the action taken in automatic mode). &#39;nomail&#39; means no mail is sent. This option is independendent of the node</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;GlobalManagerMail=nomail</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;# Thee values must be provided corresponding with DEFCON_L4,DEFCON_L3 and DEFCON_L2 (higer values means PANIC).</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;GlobalManagerWarningsPerc=85,90,95</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;# Number of &quot;grace&quot; T1 periods before doing a new re-evaluation</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;GlobalManagerGracePeriods=3</div></div><!-- fragment --><p>3) EAR Daemon (EARD)</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# The verbosity level [0..4]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;NodeDaemonVerbose=1</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# Frequency used by power monitoring service, in seconds.</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;NodeDaemonPowermonFreq=60</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# Maximum supported frequency (1 means nominal, no turbo).</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;NodeDaemonMaxPstate=1</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;# Enable (1) or disable (0) the turbo frequency</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;NodeDaemonTurbo=0</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;# The port where the EARD will be listening</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;NodeDaemonPort=5000</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;# Enables the use of the database</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;NodeUseDB=1</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;# Inserts data to MySQL sendint that data to the EARDBD (1) or directly (0).</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;NodeUseEARDBD=1</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;# &#39;1&#39; means EAR is totally controlling frequencies (targeting production systems) and 0 means EAR will not change the frequencies when users are not using EAR library (targeted to benchmarking systems)</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;NodeForceFrequencies=1</div></div><!-- fragment --><p>4) EAR Database Manager Daemon (EARDBD)</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# In seconds, time of accumulating data in every aggregation</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;DBDaemonAggregationTime=60</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# In seconds, time between insert the buffered data</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;DBDaemonInsertionTime=30</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# Port where the EARDBD server is listening</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;DBDaemonPortTCP=4711 , This port is used for main EARDBD</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;# Port where the EARDBD mirror is listening</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;DBDaemonPortSecTCP=4712</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;# Port is used to synchronize the server and mirror</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;DBDaemonSyncPort=4713</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;# Memory allocated per process. It means that if there is a server and mirror in a node a double of that value will be allocated. It is expressed in MegaBytes.</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;DBDaemonMemorySize=120</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;# The percentage of the memory block used by each type. These types are: mpi, non-mpi and learning applications, loops, energy metrics and aggregations and events, in that order.</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;DBDaemonMemorySizePerType=40,20,5,24,5,1,5</div></div><!-- fragment --><p>5) EAR Library (EARL)</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Path where coefficients are installed</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;CoefficientsDir=etc/ear/coeffs</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# Number of levels used by DynAIS algorithm.</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;DynAISLevels=4</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# Windows size used by DynAIS, the higher the size the higer the overhead.</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;DynAISWindowSize=500</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;# Maximum time in seconds that EAR will wait until a signature is computed. After this value, if no signature is computed, EAR will go to periodic mode.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;DynaisTimeout=30</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;# Time in seconds to compute every application signature when the EAR goes to periodic mode.</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;LibraryPeriod=30</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;# Number of MPI calls whether EAR must go to periodic mode or not.</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;CheckEARModeEvery=1000</div></div><!-- fragment --><p>6) Paths</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Path used for communitation files, shared memory, etc. It must be PRIVATE per compute node and with read/write permissions.</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;TmpDir=/tmp/ear</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# Path where coefficients and configuration are stored. It must be readable in all compute nodes.</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;EtcDir=/etc/ear</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# Path where metrics are generated in text files when no database is installed. A suffix is included.</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;DataBasePathName=/etc/ear/dbs/dbs.</div></div><!-- fragment --><p>7) Energy policies</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Default policy (MONITORING_ONLY, MIN_TIME_TO_SOLUTION, and MIN_ENERGY_TO_SOLUTION).</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;DefaultPowerPolicy=MIN_TIME_TO_SOLUTION</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# List of allowed policies for normal users (it is a subset of all three policies).</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;SupportedPolicies=MONITORING_ONLY,MIN_TIME_TO_SOLUTION</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# Starting P_STATE for each policy, specified in the following order: MIN_ENERGY, MIN_TIME and MONITORING_ONLY.</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;DefaultPstates=1,4,4</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;# Threshold used for MIN_TIME_TO_SOLUTION policy.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;MinEfficiencyGain=0.7</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;# Threshold used for MIN_ENERGY_TO_SOLUTION policy.</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;MaxPerformancePenalty=0.1</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;# Minimum time between two energy readings for performance accuracy</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;MinTimePerformanceAccuracy=10000000</div></div><!-- fragment --><p>8) Security</p>
<p>Authorized users that are allowed to change policies, thresholds and frequencies are supposed to be administrators. A list of users, Linux groups, and/or SLURM accounts can be provided to allow normal users to perform that actions.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AuthorizedUsers=user1,user2</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;AuthorizedAccounts=acc1,acc2,acc3</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;AuthorizedGroups=xx,yy</div></div><!-- fragment --><p>Energy tags are pre-defined configurations for some applications (EAR library is not loaded). This energy tags accept a user ids, groups and SLURM accounts of users allowed to use that tag.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;EnergyTag=memory-intensive pstate=4 users=user1,user2 groups=group1,group2 accounts=acc1,acc2</div></div><!-- fragment --><p>9) Special nodes</p>
<p>Describes nodes with some special characteristic such as different default P_STATEs, default coefficients file and/or policy thresholds.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# The &#39;MaxPerformancePenalty&#39; and &#39;MinEfficiencyGain&#39; accepts values between 0 and 1.</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;NodeName=nodename_list CPUs=24 DefaultPstates=2,5,5   DefCoefficientsSFile=filename MaxPerformancePenalty=def_th MinEfficiencyGain=def_th</div></div><!-- fragment --><p>10) Island description</p>
<p>Nodes are grouped in islands, this section is mandatory since it is used for cluster description. Normally nodes are grouped in islands shares the same hardware characteristics and also its database daemons (EARDBDS).</p>
<p>Remember that there are two kinds of database daemons. One called 'server' and other one called 'mirror'. Both performs the metrics buffering process, but just one performs the insert. The mirror will do that insert in case the 'server' process crashes or the node fails.</p>
<p>It is recommended that all islands to have symmetry. For example, if the island I0 and I1 have the server N0 and the mirror N1, the next island would have to point the same N0 and N1 or point to new ones N2 and N3.</p>
<p>Multiple EARDBDs are supported in the same island, so more than one line per island is required, but the condition of symmetry have to be met.</p>
<p>It is recommended that for a island to the server and the mirror running in different nodes. However, the EARDBD program could be both server and mirror at the same time. This means that the islands I0 and I1 could have the N0 server and the N2 mirror, and the islands I2 and I3 the N2 server and N0 mirror, fullfing the symmetry requirements.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Island=0 Nodes=nodename_list DBIP=EARDB_server_hostname   DBSECIP=EARDB_mirror_hostname</div></div><!-- fragment --><p>Detailed island accepted values:</p><ul>
<li>nodename_list accepts the following formats:<ul>
<li>Nodes=<code>node1,node2,node3</code></li>
<li>Nodes=<code>node[1-3]</code></li>
<li>Nodes=<code>node[1,2,3]</code></li>
</ul>
</li>
<li>Any combination of the two latter options will work, but if nodes have to be specified individually (the first format) as of now they have to be specified in their own line. As an example:<ul>
<li>Valid formats:<ul>
<li>Island=1 Nodes=<code>node1,node2,node3</code></li>
<li>Island=1 Nodes=<code>node[1-3],node[4,5]</code></li>
</ul>
</li>
<li>Invalid formats:<ul>
<li>Island=1 Nodes=<code>node[1,2],node3</code></li>
<li>Island=1 Nodes=<code>node[1-3],node4</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Please visit the ./README.islands.md "islands example" for more information and examples of a cluster configuration in form of islands. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
