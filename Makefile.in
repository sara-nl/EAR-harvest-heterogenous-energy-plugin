CC           = @CC@
CC_FLAGS     =
MPICC        = @MPICC@
MPICC_FLAGS  =
OMPICC       = @OMPICC@
OMPICC_FLAGS =
ROOTDIR      = $(shell pwd)
SRCDIR       = $(ROOTDIR)/src
DESTDIR      = @prefix@
ETCDIR       = @sysconfdir@
PAPI_BASE    = @PAPI_DIR@
PAPI_CFLAGS  = @PAPI_CPPFLAGS@
PAPI_LDFLAGS = @PAPI_LDFLAGS@ @PAPI_LIBS@
GSL_BASE     = @GSL_DIR@
GSL_CFLAGS   = @GSL_CPPFLAGS@
GSL_LDFLAGS  = @GSL_LDFLAGS@ @GSL_LIBS@
SLURM_BASE   = @SLURM_DIR@
SLURM_CFLAGS = @SLURM_CPPFLAGS@
CPUF_BASE    = @CPUPOWER_DIR@
CPUF_CFLAGS  = @CPUPOWER_CPPFLAGS@
CPUF_LDFLAGS = @CPUPOWER_LDFLAGS@ @CPUPOWER_LIBS@
IPMI_BASE    = @FREEIPMI_DIR@
IPMI_CFLAGS  = @FREEIPMI_CPPFLAGS@
IPMI_LDFLAGS = @FREEIPMI_LDFLAGS@ @FREEIPMI_LIBS@
DB_BASE      = @DB_DIR@
DB_CFLAGS    = @DB_CPPFLAGS@
DB_LDFLAGS   = @DB_LDFLAGS@ @DB_LIBS@
CONSTANTS    = -DEAR_BOOST -DPERFORMANCE_GAIN=0.75 -DEAR_ACCEPTED_TH=0.05 -DEAR_MIN_P_STATE=3 -DUSE_TURBO=0 -DRESET_FREQ=0
CONSTANTS   += -DMAX_POWER_ERROR=0.05 -DMAX_DYNAIS_OVERHEAD=5 -DMAX_POLICY_TRIES=3 -DDEMO=1 -DPOWERMON_FREQ=30000000
CONSTANTS   += -DDAEMON_PORT_NUMBER=50000 -DDEFAULT_T1=60 -DDEFAULT_T2=600 -DMAX_ENERGY=300 -DEARGM_PORT_NUMBER=60000
DEBUG        = 

######## VARS

export CC
export CC_FLAGS
export MPICC
export MPICC_FLAGS
export OMPICC
export OMPICC_FLAGS
export ROOTDIR
export SRCDIR
export DESTDIR
export ETCDIR
export PAPI_BASE
export PAPI_CFLAGS
export PAPI_LDFLAGS
export GSL_BASE
export GSL_CFLAGS
export GSL_LDFLAGS
export IPMI_BASE
export IPMI_CFLAGS
export IPMI_LDFLAGS
export SLURM_BASE
export SLURM_CFLAGS
export CPUF_BASE
export CPUF_LDFLAGS
export DB_BASE
export DB_CFLAGS
export DB_LDFLAGS
export CONSTANTS
export DEBUG

######## RULES

.PHONY: check functionals

all:
	@ $(MAKE) -C 'src' all || exit

check:
	@ $(MAKE) -C 'src' check

install:
	@ $(MAKE) -C 'etc' install
	@ $(MAKE) -C 'src' install
	@ $(MAKE) -C 'doc' install

clean:
	@ $(MAKE) -C 'src' clean

depend:
	@ $(MAKE) -C 'src' depend || exit